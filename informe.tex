% Clase y configuracion de tipo de documento
\documentclass[10pt,a4paper,spanish]{article}
% Inclusion de paquetes
\usepackage{a4wide}
\usepackage{amsmath, amscd, amssymb, amsthm, latexsym}
\usepackage[spanish]{babel}
\usepackage[utf8]{inputenc}
\usepackage[width=15.5cm, left=3cm, top=2.5cm, height= 24.5cm]{geometry}
\usepackage{fancyhdr}
\pagestyle{fancyplain}
\usepackage{listings}
\usepackage{enumerate}
\usepackage{xspace}
\usepackage{longtable}
\usepackage{caratula}
% incluye macros espec materia
\include{algo1-cmds}

% Encabezado
\lhead{Algoritmos y Estructuras de Datos I}
\rhead{Grupo 07}
% Pie de pagina
\renewcommand{\footrulewidth}{0.4pt}
\lfoot{Facultad de Ciencias Exactas y Naturales}
\rfoot{Universidad de Buenos Aires}

\begin{document}

% Datos de caratula
\materia{Algoritmos y Estructuras de Datos I}
\titulo{Trabajo Pr\'actico N\'umero 1}
%\subtitulo{}
\grupo{Grupo: 07}

\integrante{Demartino, Francisco}{348/14}{demartino.francisco@gmail.com}
\integrante{Frachtenberg Goldsmit, Kevin}{247/14}{kevinfra94@gmail.com}
\integrante{Gomez, Horacio}{756/13}{horaciogomez.1993@gmail.com}
\integrante{Pondal, Iván}{078/14}{ivan.pondal@gmail.com}

\maketitle

\newpage

% Para crear un indice
%\tableofcontents

% Forzar salto de pagina
\clearpage

% Pueden modularizar el documento incluyendo otros .tex
% \include{observaciones}

\section{Observaciones}

	\begin{enumerate}
		\item A lo largo de la confección de este trabajo práctico, nos surgió la duda acerca de si considerar una imagen vacía de 0x0 como válida. Ante las respuestas obtenidas de los docentes, quienes nos indicaron que podíamos o no considerarla como válida, decidimos dejarla como imágen no valida a raíz de que, por ejemplo, en el caso del filtro ``Dividir'', podrían generarse infinitas imágenes vacías.
	\end{enumerate}

% Otro salto de pagina
% \newpage

\section{Resolución}

\begin{ejercicio}
	Especificación Blur:

	\begin{problema}{Blur}{imagenOriginal:Imagen, k:\ent}{imagenNueva:Imagen}
		\requiere{k > 0 \land imagenV\acute{a}lida(imagenOriginal)}
		\asegura{imagenV\acute{a}lida(imagenNueva)}
		\asegura{mismoTama\tilde{n}o(imagenOriginal, imagenNueva)}
		\asegura{todos([imagenNueva[y][x] == colorPromedioEnPosici\acute{o}n(imagenOriginal,x,y,k) \linebreak | \  x \leftarrow [0..ancho(im)),y \leftarrow [0..alto(im))])}
	\end{problema}

\end{ejercicio}

\begin{ejercicio}
	Especificación Acuarela:
	
	\begin{problema}{Acuarela}{imgOriginal:Imagen, k:\ent}{imgFinal:Imagen}
		\requiere{k > 0 \land imagenV\acute{a}lida(imgOriginal)}
		\asegura{imagenV\acute{a}lida(imgFinal)}
		\asegura{mismoTama\tilde{n}o(imgOriginal, \ imgFinal)}
		\asegura{filtroAcuarela(imgOriginal, \ imgFinal, \ k)}
	\end{problema}

\end{ejercicio}

\begin{ejercicio}
	Especificación Dividir:
	
	\begin{problema}{Dividir}{im : Imagen, m, n : \ent}{listaPartes:[Imagen]}
		\requiere {m>0 \land n>0}
		\requiere {imagenValida(im) \land imagenValida(im)}
		\requiere {ancho(im)\ mod \ n==0}
		\requiere {alto(im) \ mod\ m==0}
		\asegura {mismos (listaPartes, imCortadas (im, m, n))}
		\asegura {todos([alto(parte) == alto(im) \ div \ m \land 
		 ancho(parte) ==ancho(im) \ div \ n | parte \leftarrow listaPartes])}
	\end{problema}

\end{ejercicio}

\begin{ejercicio}
	Especificación Pegar:
	
	\begin{problema*}{Pegar}{destino : Imagen, col : Pixel, origen: Imagen}
		\modifica {destino}
		\requiere {imagenValida(origen) \land imagenValida(pre(destino))}
		\asegura { \lnot imagenTieneHuecoPegar(pre(destino), origen, col) \rightarrow destino == pre(destino)}
    	\asegura {imagenTieneHuecoPegar(pre(destino), origen, col) \rightarrow aplicaPegar(pre(destino), destino, huecoPegar(origen, col), origen)}
	\end{problema*}

\end{ejercicio}

\subsection{Auxiliares}

\begin{itemize}

	\item \auxil{pixelNegro : Pixel}{ 
		(0, 0, 0)
	}
	
	\item \auxil{canalesRojos(ps : [Pixel]) : [\ent]}{ 
		[prm(p) \ | \ p \leftarrow ps]
	}
	
	\item \auxil{canalesVerdes(ps : [Pixel]) : [\ent]}{ 
		[sgd(p) \ | \ p \leftarrow ps]
	}
	
	\item \auxil{canalesAzules(ps : [Pixel]) : [\ent]}{ 
		[ter(p) \ | \ p \leftarrow ps]
	}

	\item \auxil{
			cuenta(x:T, a:\TLista{T}) : \ent
		     }{ 
			\longitud {
			  \TLista{1 | y \leftarrow a, y==x}
			}
		}

	\item \auxil{mismos(a, b: \TLista{T}) : Bool}{ 
		|a| == |b| \land (\forall c \leftarrow a) cuenta(c,a) == cuenta(c,b)
	}

	\item \auxil{concat(ts : \TLista{\TLista{T}}) : \TLista{T}}{
		[tss[i][j] | i \leftarrow [0..|tss|), j \leftarrow  [0..|tss[i]|)]
	}

	\item \auxil{todosIguales(ts : \TLista{T}) : Bool}{(\longitud{ls} == 0) \vee cuenta(ts[0], ts) == \longitud{ts}}

	\item \auxil{alto(im:Imagen) : \ent}{\longitud{im}}
	
	\item \auxil{ancho(im: Imagen) : \ent}{ ifThenElse (alto(im) == 0,0,\longitud{im[0]})}
	
	\item \auxil{listaAnchos(im: Imagen) : \ent}{ 
	 [|im[i]| \ | \ i \leftarrow [0..|im|)]
	}
	

	\item \auxil{pixelV\acute{a}lido(p : Pixel) : Bool}{
	\\ (prm(p) \geq 0) \ \land \ (prm(p) < 256) \ \land \ (sgd(p) \geq 0) \ \land \ (sgd(p) < 256) \ \land \ (ter(p) \geq 0) \ \land \ (ter(p) < 256)}

	\item \auxil{imagenV\acute{a}lida(im:Imagen) : Bool}{ ancho(im) > 0 \ \land \ alto(im) > 0 \ \land \\ todosIguales(listaAnchos(im)) \ \land \ todos([imagenV\acute{a}lida(p) \ | \ p \leftarrow concat(im)])}
		
	\item \auxil{mismoTama\tilde{n}o(a,b:Imagen) : Bool}{ 
	ancho(a)==ancho(b) \ \land \ alto(a)==alto(b)}
	
	\item \auxil{kVecinosCompletos(k, x, y: \ent, im : Imagen) : Bool}{ 
	 (x >= k) \land
    (y >= k) \land \\
    (x < ancho(im) - k) \land
    (y < alto(im) - k)
	}
	
	\item \auxil{kVecinos(k, x, y: \ent, im: Imagen) : [Pixel]}{ 
	\\
	concat(subImagen(x-k, x+k, y-k, y+k, im))
	}
	
	\item \auxil{promedio(ns: [\ent]) : \ent}{ 
	\suma {ns} \ div \ |ns|
	}
	
	\item \auxil{pixelPromedio(ps : [Pixel]) : Pixel}{ \\
	(promedio(canalesRojos(ps)), \ promedio(canalesVerdes(ps)), \ promedio(canalesAzules(ps)))
	}

	\item \auxil{colorPromedioEnPosici\acute{o}n(im : Imagen, x, y, k: \ent) : Pixel}{ 
	\\ ifThenElse(kVecinosCompletos(k, x, y, im), pixelPromedio(kVecinos(k, x,y,im)), pixelNegro)
	}
	
	\item \auxil{filtroAcuarela(imgOriginal, imgFinal: Imagen, k: \ent) : Bool}{ 
	\\ todos([pixelCumpleFiltroAcuarela(imgOriginal, ImgFinal, k, x, y)  
	\\ | \ y \leftarrow [0..alto(imgOriginal) ), x \leftarrow 0..ancho(imgOriginal) )])
	}
	
	\item \auxil{pixelCumpleFiltroAcuarela(imgOriginal, imgFinal: Imagen, k, x, y : \ent) : Bool}{ 
	\\ ifThenElse(
kVecinosCompletos(k, x, y, imgOriginal), 
\\ pixelEsMedianaLista(imgFinal[y][x], kVecinos(k, x, y, imgOriginal) ), 
\\ imgFinal[y][x]==pixelNegro
)
	}

\item \auxil{pixelEsMedianaLista(px: Pixel, listaPixeles: [Pixel]) : Bool}{ 
\\ esMediana(canalesRojos(listaPixeles),prm(px)) \ \land \
esMediana(canalesVerdes(listaPixeles),sgd(px)) \ \land \
esMediana(canalesAzules(listaPixeles),ter(px))
}

\item \auxil{esMediana(xs:[\ent], x:\ent) : Bool}{ 
	\\ |menores(xs,x)| < (|xs| \ div \ 2) \land |menoresIguales(xs,x)| \geq (|xs| \ div \ 2)
}

\item \auxil{menores(xs: [\ent], x: \ent) : \ent}{
	|[1 | y \leftarrow xs, y < x]|
}

\item \auxil{menoresIguales(xs: [\ent], x: \ent) : \ent}{
	|[1 | y \leftarrow xs, y \leq x]|
}


\item \auxil{subImagen(x0, x1, y0, y1 : \ent, im : Imagen) : Imagen}{
	$ \\ $ [ 
[ im[i][j] 
| j \leftarrow [x0...x1] 
] 
| i \leftarrow [y0...y1]
]
}

\item \auxil{imCortadas(im: Imagen, m, n : \ent) : [Imagen]}{
	$ \\ $ [subImagen((i*ancho(im) \ div \ n), ((i+1)*ancho(im) \ div \ n) - 1, (j*alto(im) \ div \ m), \\ ((j+1)*alto(im) \ div \ m) - 1, im) | i \leftarrow [0..m) , j \leftarrow [0..n)
}

\item \auxil{contieneSubImagen(grande, chica : Imagen) : Bool}{
	\\ alguno([
chica == subImagen(x0, \ x0 \ + \ ancho(chica) \ - \ 1, \ y0, \ y0 \ + \ ancho(chica) \- \ 1, \ grande) 
	\\ | x0 \leftarrow [0...ancho(grande) - ancho(chica)], 
  y0 \leftarrow [0...alto(grande) - alto(chica)]	
])
}

\item \auxil{imagenTieneHuecoPegar(destino, origen: Imagen, col) : Bool}{
	\\ contieneSubImagen(destino, huecoPegar(origen, col))
}

\item \auxil{huecoGrande(col : Pixel, alto, ancho : \ent) : Imagen}{
	[col | j \leftarrow [0..ancho)] | i \leftarrow [0..alto)]
}

\item \auxil{huecoPegar(im : Imagen, col : Pixel) : Imagen}{
	huecoGrande(col, alto(im), ancho(im))
}

\item \auxil{aplicaPegar(grande1, grande2, chica1, chica2 : Imagen) : Bool}{
	\\ mismoTama\tilde{n}o(grande1, grande2) \ \land \ mismoTama\tilde{n}o(chica1, chica2)\ \land \
		\\ alguno([
		chica1 == subImagen(x0,  x0  +  ancho(chica1)  - 1, y0 , y0  + alto(chica1) -  1,  grande1) \ \land \ chica2 == subImagen(x0, x0 + ancho(chica2) - 1, y0, y0 + alto(chica2) - 1, grande2) \ \land \ \\ sonIgualesSalvoRectangulo(grande1, grande2, x0, x0+ancho(chica1) - 1, y0, y1+alto(chica1) - 1)
\\ | x0 \leftarrow [0...ancho(grande1) - ancho(chica1)], y0 \leftarrow [0...alto(grande1) - alto(chica1)]	
])
}

\item \auxil{sonIgualesSalvoRectangulo(im1, im2 : Imagen, x0, x1, y0, y1 : \ent) : Bool}{
	\\ todos([im1[y][x] == im2[y][x] \lor (enRango(y, y0, y1) \land enRango(x, x0, x1)) 
	\\ | x \leftarrow [x0..x1], y \leftarrow [y0..y1]])
}

\item \auxil{enRango(a, inicio, fin : \ent) : Bool}{
	inicio \leq a \land a \leq fin
}

\end{itemize}
        
\end{document}
